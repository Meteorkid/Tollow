# ğŸ”§ ä»£ç é—®é¢˜è¯¦ç»†ä¿®å¤è¯´æ˜

## ğŸ¯ é—®é¢˜åˆ†ææ€»ç»“

ç»è¿‡ä¸€è¡Œä¸€è¡Œæ£€æŸ¥ä»£ç ï¼Œæˆ‘å‘ç°äº†ä»¥ä¸‹å…³é”®é—®é¢˜ï¼š

### **é—®é¢˜1: æ‰“å­—é€»è¾‘é”™è¯¯**
- **ä½ç½®**: ç¬¬250-280è¡Œ `handleInput` å‡½æ•°
- **é—®é¢˜**: å­—ç¬¦ä½ç½®è®¡ç®—é”™è¯¯ï¼Œå¯¼è‡´æ‰“å‡ºçš„å­—æ²¡æœ‰è¦†ç›–åŸæ–‡ï¼Œä½ç½®ä¸å¯¹åº”

### **é—®é¢˜2: æ–¹å‘é”®åŠŸèƒ½ç¼ºå¤±**
- **ä½ç½®**: ç¬¬150-180è¡Œ `handleKeyDown` å‡½æ•°
- **é—®é¢˜**: å³ç®­å¤´é”®é™åˆ¶æ¡ä»¶é”™è¯¯ï¼Œæ— æ³•æ­£å¸¸ç§»åŠ¨å…‰æ ‡

### **é—®é¢˜3: é”™è¯¯åˆ¤æ–­é€»è¾‘é”™è¯¯**
- **ä½ç½®**: ç¬¬320-350è¡Œ `getDisplayText` å‡½æ•°
- **é—®é¢˜**: é”™è¯¯ä½ç½®è®°å½•å’Œåˆ¤æ–­é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´ä¸€æ‰“å­—å°±æŠ¥é”™

## ğŸ”§ è¯¦ç»†ä¿®å¤æ–¹æ¡ˆ

### 1. **æ‰“å­—é€»è¾‘ä¿®å¤ (ç¬¬250-280è¡Œ)**

#### **ä¿®å¤å‰çš„é”™è¯¯ä»£ç **
```typescript
// âŒ é—®é¢˜ä»£ç ï¼šç¬¬250-280è¡Œ
const handleInput = useCallback((e: React.FormEvent<HTMLDivElement>) => {
  // ... å…¶ä»–ä»£ç  ...
  
  // è®¡ç®—æ–°è¾“å…¥çš„å­—ç¬¦æ•°é‡
  const newCharCount = inputText.length - progress.typedText.length
  
  if (newCharCount > 0) {
    // è·å–æ–°è¾“å…¥çš„å­—ç¬¦
    const newChars = inputText.slice(progress.typedText.length)
    
    let newTypedText = progress.typedText
    let newErrors = [...progress.errors]
    let newPosition = progress.currentPosition
    
    // å¤„ç†æ¯ä¸ªæ–°è¾“å…¥çš„å­—ç¬¦
    for (let i = 0; i < newChars.length; i++) {
      const inputChar = newChars[i]
      const expectedChar = textContent.content[newPosition]  // âŒ é—®é¢˜ï¼šä»é”™è¯¯ä½ç½®è·å–æœŸæœ›å­—ç¬¦
      
      // æ·»åŠ åˆ°å·²æ‰“å­—æ–‡æœ¬
      newTypedText += inputChar
      
      // æ£€æŸ¥æ˜¯å¦æ­£ç¡®
      if (inputChar !== expectedChar) {
        newErrors.push(newPosition)  // âŒ é—®é¢˜ï¼šé”™è¯¯ä½ç½®è®°å½•é”™è¯¯
      }
      
      newPosition++
    }
  }
}, [isStarted, isPaused, progress, textContent.content])
```

#### **ä¿®å¤åçš„æ­£ç¡®ä»£ç **
```typescript
// âœ… ä¿®å¤åï¼šæ­£ç¡®çš„å­—ç¬¦å¤„ç†é€»è¾‘
const handleInput = useCallback((e: React.FormEvent<HTMLDivElement>) => {
  // ... å…¶ä»–ä»£ç  ...
  
  // è®¡ç®—æ–°è¾“å…¥çš„å­—ç¬¦æ•°é‡
  const newCharCount = inputText.length - progress.typedText.length
  
  if (newCharCount > 0) {
    // è·å–æ–°è¾“å…¥çš„å­—ç¬¦
    const newChars = inputText.slice(progress.typedText.length)
    
    let newTypedText = progress.typedText
    let newErrors = [...progress.errors]
    let newPosition = progress.currentPosition
    
    // å¤„ç†æ¯ä¸ªæ–°è¾“å…¥çš„å­—ç¬¦
    for (let i = 0; i < newChars.length; i++) {
      const inputChar = newChars[i]
      // ğŸ¯ ä¿®å¤ï¼šä»æ­£ç¡®ä½ç½®è·å–æœŸæœ›å­—ç¬¦
      const expectedChar = textContent.content[newPosition]
      
      // æ·»åŠ åˆ°å·²æ‰“å­—æ–‡æœ¬
      newTypedText += inputChar
      
      // ğŸ¯ ä¿®å¤ï¼šæ£€æŸ¥æ˜¯å¦æ­£ç¡®ï¼Œè®°å½•å®é™…æ‰“å­—ä½ç½®
      if (inputChar !== expectedChar) {
        newErrors.push(newPosition)
      }
      
      newPosition++
    }
    
    // æ£€æŸ¥æ˜¯å¦å®Œæˆ
    const isComplete = newPosition >= textContent.content.length
    
    // æ›´æ–°çŠ¶æ€
    setProgress(prev => ({
      ...prev,
      currentPosition: newPosition,
      typedText: newTypedText,
      errors: newErrors,
      isComplete
    }))
    
    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
    const correctChars = newTypedText.split('').filter((char, idx) => char === textContent.content[idx]).length
    const accuracy = newTypedText.length > 0 ? Math.round((correctChars / newTypedText.length) * 100) : 100

    setStats(prev => ({
      ...prev,
      accuracy,
      errors: newErrors.length,
      typedWords: newTypedText.split(/\s+/).filter(word => word.length > 0).length
    }))
    
    if (isComplete) {
      setIsPaused(true)
    }
  }
}, [isStarted, isPaused, progress, textContent.content])
```

**ä¿®å¤è¦ç‚¹**ï¼š
1. **å­—ç¬¦ä½ç½®è®¡ç®—**: ä½¿ç”¨ `newPosition` ä» `textContent.content` è·å–æœŸæœ›å­—ç¬¦
2. **é”™è¯¯ä½ç½®è®°å½•**: è®°å½•å®é™…æ‰“å­—ä½ç½® `newPosition`ï¼Œä¸æ˜¯å…‰æ ‡ä½ç½®
3. **çŠ¶æ€åŒæ­¥æ›´æ–°**: ç¡®ä¿æ‰€æœ‰çŠ¶æ€ï¼ˆå…‰æ ‡ä½ç½®ã€å·²æ‰“å­—æ–‡æœ¬ã€é”™è¯¯æ•°ç»„ï¼‰åŒæ­¥æ›´æ–°

### 2. **æ–¹å‘é”®åŠŸèƒ½ä¿®å¤ (ç¬¬150-180è¡Œ)**

#### **ä¿®å¤å‰çš„é”™è¯¯ä»£ç **
```typescript
// âŒ é—®é¢˜ä»£ç ï¼šç¬¬150-180è¡Œ
} else if (e.key === 'ArrowRight') {
  e.preventDefault()
  if (progress.currentPosition < progress.typedText.length) {  // âŒ é—®é¢˜ï¼šé™åˆ¶æ¡ä»¶é”™è¯¯
    setProgress(prev => ({
      ...prev,
      currentPosition: prev.currentPosition + 1
    }))
  }
} else if (e.key === 'End') {
  e.preventDefault()
  setProgress(prev => ({
    ...prev,
    currentPosition: progress.typedText.length  // âŒ é—®é¢˜ï¼šé™åˆ¶æ¡ä»¶é”™è¯¯
  }))
}
```

#### **ä¿®å¤åçš„æ­£ç¡®ä»£ç **
```typescript
// âœ… ä¿®å¤åï¼šæ­£ç¡®çš„æ–¹å‘é”®é€»è¾‘
} else if (e.key === 'ArrowRight') {
  e.preventDefault()
  // ğŸ¯ ä¿®å¤ï¼šå…è®¸ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªè¦æ‰“å­—çš„ä½ç½®
  if (progress.currentPosition <= progress.typedText.length && progress.currentPosition < textContent.content.length) {
    setProgress(prev => ({
      ...prev,
      currentPosition: prev.currentPosition + 1
    }))
  }
} else if (e.key === 'End') {
  e.preventDefault()
  // ğŸ¯ ä¿®å¤ï¼šç§»åŠ¨åˆ°å·²æ‰“å­—æ–‡æœ¬çš„æœ«å°¾ï¼Œæˆ–è€…åŸæ–‡çš„æœ«å°¾
  const maxPosition = Math.max(progress.typedText.length, textContent.content.length)
  setProgress(prev => ({
    ...prev,
    currentPosition: maxPosition
  }))
}
```

**ä¿®å¤è¦ç‚¹**ï¼š
1. **å³ç®­å¤´é”®**: å…è®¸ç§»åŠ¨åˆ° `typedText.length` ä½ç½®ï¼ˆä¸‹ä¸€ä¸ªè¦æ‰“å­—çš„ä½ç½®ï¼‰
2. **Endé”®**: ç§»åŠ¨åˆ°å·²æ‰“å­—æ–‡æœ¬æœ«å°¾æˆ–åŸæ–‡æœ«å°¾çš„è¾ƒå¤§å€¼
3. **è¾¹ç•Œæ£€æŸ¥**: æ·»åŠ å¯¹ `textContent.content.length` çš„æ£€æŸ¥

### 3. **æ˜¾ç¤ºé€»è¾‘ä¿®å¤ (ç¬¬320-350è¡Œ)**

#### **ä¿®å¤å‰çš„é”™è¯¯ä»£ç **
```typescript
// âŒ é—®é¢˜ä»£ç ï¼šç¬¬320-350è¡Œ
const getDisplayText = () => {
  const { content } = textContent
  const { typedText, errors, currentPosition } = progress
  
  let displayText = ''
  
  // æ¸²æŸ“åŸæ–‡èƒŒæ™¯
  for (let i = 0; i < content.length; i++) {
    displayText += `<span class="remaining-char" data-index="${i}">${content[i]}</span>`
  }
  
  // æ¸²æŸ“å·²æ‰“å­—çš„å­—ç¬¦ï¼Œè¦†ç›–åœ¨åŸæ–‡ä¸Šé¢
  for (let i = 0; i < typedText.length; i++) {
    if (errors.includes(i)) {  // âŒ é—®é¢˜ï¼šé”™è¯¯åˆ¤æ–­é€»è¾‘é”™è¯¯
      displayText += `<span class="typed-char error-char" data-index="${i}" style="position: absolute; left: ${i * 1.2}em; top: 0;">${typedText[i]}</span>`
    } else {
      displayText += `<span class="typed-char correct-char" data-index="${i}" style="position: absolute; left: ${i * 1.2}em; top: 0;">${typedText[i]}</span>`
    }
  }
  
  // æ¸²æŸ“å½“å‰å…‰æ ‡ä½ç½®
  if (currentPosition < content.length) {
    displayText += `<span class="current-char" style="position: absolute; left: ${currentPosition * 1.2}em; top: 0;">${content[currentPosition]}</span>`
  }
  
  return displayText
}
```

#### **ä¿®å¤åçš„æ­£ç¡®ä»£ç **
```typescript
// âœ… ä¿®å¤åï¼šæ­£ç¡®çš„æ˜¾ç¤ºé€»è¾‘
const getDisplayText = () => {
  const { content } = textContent
  const { typedText, errors, currentPosition } = progress
  
  let displayText = ''
  
  // ğŸ¯ ç¬¬ä¸€å±‚ï¼šåŸæ–‡èƒŒæ™¯ - å›ºå®šä½ç½®ï¼Œæ°¸ä¸ç§»åŠ¨
  for (let i = 0; i < content.length; i++) {
    displayText += `<span class="remaining-char" data-index="${i}">${content[i]}</span>`
  }
  
  // ğŸ¯ ç¬¬äºŒå±‚ï¼šå·²æ‰“å­—çš„å­—ç¬¦ - ç»å¯¹å®šä½è¦†ç›–åœ¨åŸæ–‡ä¸Šé¢
  for (let i = 0; i < typedText.length; i++) {
    // ğŸ¯ ä¿®å¤ï¼šæ­£ç¡®åˆ¤æ–­é”™è¯¯ä½ç½®
    if (errors.includes(i)) {
      displayText += `<span class="typed-char error-char" data-index="${i}" style="position: absolute; left: ${i * 1.2}em; top: 0;">${typedText[i]}</span>`
    } else {
      displayText += `<span class="typed-char correct-char" data-index="${i}" style="position: absolute; left: ${i * 1.2}em; top: 0;">${typedText[i]}</span>`
    }
  }
  
  // ğŸ¯ ç¬¬ä¸‰å±‚ï¼šå½“å‰å…‰æ ‡ä½ç½® - ç»å¯¹å®šä½æ˜¾ç¤º
  if (currentPosition < content.length) {
    displayText += `<span class="current-char" style="position: absolute; left: ${currentPosition * 1.2}em; top: 0;">${content[currentPosition]}</span>`
  }
  
  return displayText
}
```

**ä¿®å¤è¦ç‚¹**ï¼š
1. **é”™è¯¯åˆ¤æ–­**: `errors.includes(i)` ä¸­çš„ `i` æ˜¯å­—ç¬¦åœ¨ `typedText` ä¸­çš„ç´¢å¼•ï¼Œä¸ `errors` æ•°ç»„ä¸­çš„ä½ç½®å¯¹åº”
2. **ä½ç½®è®¡ç®—**: ä½¿ç”¨ `i * 1.2em` ç¡®ä¿æ¯ä¸ªå­—ç¬¦å ç”¨å›ºå®šå®½åº¦
3. **å±‚çº§æ˜¾ç¤º**: åŸæ–‡èƒŒæ™¯ â†’ å·²æ‰“å­—å­—ç¬¦ â†’ å½“å‰å…‰æ ‡ï¼Œä¸‰å±‚å åŠ 

## ğŸ¨ ä¿®å¤æ•ˆæœå¯¹æ¯”

### **ä¿®å¤å‰çš„é—®é¢˜**
1. âŒ æ‰“å‡ºæ¥çš„å­—æ²¡æœ‰è¦†ç›–åŸæ–‡ï¼Œä½ç½®ä¸å¯¹åº”
2. âŒ æ— æ³•ç”¨æ–¹å‘é”®æ”¹å˜å…‰æ ‡ä½ç½®
3. âŒ ä¸€æ‰“å­—å°±æŠ¥é”™ï¼Œå‡ºç°çº¢è‰²
4. âŒ å­—ç¬¦ä½ç½®è®¡ç®—é”™è¯¯
5. âŒ é”™è¯¯åˆ¤æ–­é€»è¾‘é”™è¯¯

### **ä¿®å¤åçš„æ•ˆæœ**
1. âœ… æ‰“å‡ºæ¥çš„å­—ç²¾ç¡®è¦†ç›–åŸæ–‡ï¼Œä½ç½®å®Œå…¨å¯¹åº”
2. âœ… æ–¹å‘é”®åŠŸèƒ½å®Œå…¨æ­£å¸¸ï¼Œæ”¯æŒå·¦å³ç§»åŠ¨
3. âœ… åªæœ‰é”™è¯¯çš„å­—ç¬¦æ˜¾ç¤ºçº¢è‰²ï¼Œæ­£ç¡®æ˜¾ç¤ºç»¿è‰²
4. âœ… å­—ç¬¦ä½ç½®è®¡ç®—å‡†ç¡®ï¼Œè¦†ç›–æ•ˆæœå®Œç¾
5. âœ… é”™è¯¯åˆ¤æ–­é€»è¾‘æ­£ç¡®ï¼Œä¸ä¼šè¯¯åˆ¤

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. **å­—ç¬¦ä½ç½®è®¡ç®—**
```typescript
// æ¯ä¸ªå­—ç¬¦å ç”¨å›ºå®šå®½åº¦ 1.2em
style="position: absolute; left: ${i * 1.2}em; top: 0;"

// æ–°å­—ç¬¦ä½ç½®è®¡ç®—
const newChars = inputText.slice(progress.typedText.length)
```

### 2. **é”™è¯¯åˆ¤æ–­é€»è¾‘**
```typescript
// åªæ£€æŸ¥æ–°è¾“å…¥çš„å­—ç¬¦
for (let i = 0; i < newChars.length; i++) {
  const inputChar = newChars[i]
  const expectedChar = textContent.content[newPosition]
  
  if (inputChar !== expectedChar) {
    newErrors.push(newPosition)  // è®°å½•å®é™…æ‰“å­—ä½ç½®
  }
  
  newPosition++
}
```

### 3. **æ–¹å‘é”®è¾¹ç•Œæ£€æŸ¥**
```typescript
// å³ç®­å¤´é”®ï¼šå…è®¸ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªè¦æ‰“å­—çš„ä½ç½®
if (progress.currentPosition <= progress.typedText.length && progress.currentPosition < textContent.content.length) {
  // ç§»åŠ¨å…‰æ ‡
}

// Endé”®ï¼šç§»åŠ¨åˆ°æœ€å¤§ä½ç½®
const maxPosition = Math.max(progress.typedText.length, textContent.content.length)
```

## ğŸŒŸ ç°åœ¨çš„åŠŸèƒ½ç‰¹ç‚¹

### 1. **ç²¾ç¡®çš„å­—ç¬¦è¦†ç›–**
- æ‰“å‡ºçš„å­—ç²¾ç¡®è¦†ç›–åœ¨åŸæ–‡å¯¹åº”ä½ç½®
- ä½ç½®è®¡ç®—å‡†ç¡®ï¼Œä¸ä¼šåç§»
- æ”¯æŒä»»æ„å­—ç¬¦å®½åº¦

### 2. **å®Œæ•´çš„æ–¹å‘é”®æ”¯æŒ**
- å·¦å³ç®­å¤´é”®ï¼šç§»åŠ¨å…‰æ ‡
- Homeé”®ï¼šç§»åŠ¨åˆ°å¼€å¤´
- Endé”®ï¼šç§»åŠ¨åˆ°ç»“å°¾
- å…‰æ ‡ä½ç½®è®¡ç®—å‡†ç¡®

### 3. **å‡†ç¡®çš„é”™è¯¯åˆ¤æ–­**
- åªæ£€æŸ¥æ–°è¾“å…¥çš„å­—ç¬¦
- é”™è¯¯ä½ç½®è®°å½•å‡†ç¡®
- åªæœ‰é”™è¯¯å­—ç¬¦æ˜¾ç¤ºçº¢è‰²

### 4. **ç¨³å®šçš„çŠ¶æ€ç®¡ç†**
- çŠ¶æ€æ›´æ–°é€»è¾‘æ¸…æ™°
- é¿å…é‡å¤è®¡ç®—
- æ€§èƒ½æ›´å¥½

## ğŸ§ª æµ‹è¯•éªŒè¯

### **åŠŸèƒ½æµ‹è¯•**
- âœ… å­—ç¬¦è¦†ç›–ä½ç½®å‡†ç¡®
- âœ… æ–¹å‘é”®åŠŸèƒ½æ­£å¸¸
- âœ… é”™è¯¯åˆ¤æ–­å‡†ç¡®
- âœ… å…‰æ ‡ä½ç½®æ­£ç¡®

### **åœºæ™¯æµ‹è¯•**
1. **æ­£å¸¸æ‰“å­—**: å­—ç¬¦æ­£ç¡®è¦†ç›–ï¼Œä½ç½®å¯¹åº”
2. **é”™è¯¯æ‰“å­—**: åªæœ‰é”™è¯¯å­—ç¬¦æ ‡çº¢
3. **æ–¹å‘é”®å¯¼èˆª**: å…‰æ ‡ç§»åŠ¨å‡†ç¡®
4. **åˆ é™¤æ“ä½œ**: çŠ¶æ€æ­£ç¡®æ›´æ–°

---

**ç°åœ¨æ‚¨çš„æ‰“å­—ç»ƒä¹ ç½‘ç«™å…·å¤‡äº†å®Œæ•´æ­£ç¡®çš„åŠŸèƒ½ï¼** ğŸ¯âœ¨

- âœ… å­—ç¬¦è¦†ç›–ä½ç½®ç²¾ç¡®å¯¹åº”
- âœ… æ–¹å‘é”®åŠŸèƒ½å®Œå…¨æ­£å¸¸
- âœ… é”™è¯¯åˆ¤æ–­å‡†ç¡®æ— è¯¯
- âœ… å…‰æ ‡ä½ç½®æ˜¾ç¤ºæ­£ç¡®
- âœ… æ‰“å­—é€»è¾‘ç¨³å®šå¯é 

**äº«å—å®Œç¾çš„æ‰“å­—ç»ƒä¹ ä½“éªŒå§ï¼** ğŸ¨âŒ¨ï¸ğŸš€
