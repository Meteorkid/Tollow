# 打字练习网站部署指南

## 🚀 快速部署

### 1. 本地开发

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 访问 http://localhost:4000
```

### 2. 生产构建

```bash
# 构建生产版本
npm run build

# 预览生产版本
npm run preview
```

### 3. 使用部署脚本

```bash
# 运行部署脚本
./deploy.sh
```

## 🌐 服务器部署

### 静态文件部署

1. **构建项目**
   ```bash
   npm run build
   ```

2. **上传文件**
   - 将 `dist/` 目录中的所有文件上传到您的Web服务器
   - 确保文件权限正确（通常是644）

3. **配置服务器**

#### Nginx配置示例
```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /var/www/typing-practice;
    index index.html;

    # 支持单页应用路由
    location / {
        try_files $uri $uri/ /index.html;
    }

    # 静态资源缓存
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # 安全头
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
}
```

#### Apache配置示例
```apache
<VirtualHost *:80>
    ServerName your-domain.com
    DocumentRoot /var/www/typing-practice
    
    <Directory /var/www/typing-practice>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    # 支持单页应用路由
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ /index.html [QSA,L]
</VirtualHost>
```

### 4. 环境变量配置

如果需要配置环境变量，创建 `.env` 文件：

```env
VITE_APP_TITLE=打字练习网站
VITE_APP_DESCRIPTION=提升您的打字技能
```

### 5. HTTPS配置

强烈建议启用HTTPS：

```bash
# 使用Let's Encrypt免费证书
sudo certbot --nginx -d your-domain.com
```

## 📱 移动端优化

### PWA支持

1. 创建 `public/manifest.json`：
```json
{
  "name": "打字练习",
  "short_name": "打字练习",
  "description": "提升您的打字技能",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#007bff",
  "icons": [
    {
      "src": "/icon-192.png",
      "sizes": "192x192",
      "type": "image/png"
    }
  ]
}
```

2. 在 `index.html` 中添加：
```html
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#007bff">
```

## 🔧 性能优化

### 1. 代码分割
项目已配置Vite的代码分割功能

### 2. 静态资源优化
- 图片压缩
- CSS/JS压缩
- Gzip压缩

### 3. CDN配置
```nginx
# 静态资源CDN
location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
    # 可以配置CDN域名
}
```

## 📊 监控和分析

### 1. 错误监控
```javascript
// 在main.tsx中添加
window.addEventListener('error', (event) => {
    console.error('Global error:', event.error);
    // 发送到错误监控服务
});
```

### 2. 性能监控
```javascript
// 监控页面加载性能
window.addEventListener('load', () => {
    const perfData = performance.getEntriesByType('navigation')[0];
    console.log('Page load time:', perfData.loadEventEnd - perfData.loadEventStart);
});
```

## 🚨 故障排除

### 常见问题

1. **路由404错误**
   - 确保服务器配置了单页应用路由支持
   - 检查 `try_files` 或 `RewriteRule` 配置

2. **静态资源加载失败**
   - 检查文件路径和权限
   - 确认MIME类型配置正确

3. **构建失败**
   - 检查Node.js版本（建议16+）
   - 清除 `node_modules` 重新安装

4. **性能问题**
   - 启用Gzip压缩
   - 配置适当的缓存策略
   - 使用CDN加速

## 📞 技术支持

如果遇到问题，请检查：
1. 浏览器控制台错误信息
2. 服务器日志
3. 网络请求状态
4. 文件权限和路径

## 🎯 下一步

部署完成后，您可以：
- 配置域名和SSL证书
- 设置监控和分析工具
- 优化性能和用户体验
- 添加更多功能特性

---

**祝您部署顺利！** 🚀✨
